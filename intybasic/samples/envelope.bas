	REM
	REM Envelope volume usage
	REM by Oscar Toledo G. http://nanochess.org/
	REM Jan/23/2016
	REM

	INCLUDE "constants.bas"

	PRINT AT 0,"ENVELOPE TEST"

	PRINT AT 21,"1 - PIANO NOTE"
	PRINT AT 41,"2 - SEAWAVES"
	PRINT AT 61,"3 - HELICOPTER"
        PRINT AT 81,"4 - DRUMS ROLLING"
	PRINT AT 101,"5 - SIREN"

main_loop:
	DO
	WAIT
 	LOOP UNTIL cont.key <> 12

	IF cont.key = 1 THEN GOSUB effect1
	IF cont.key = 2 THEN GOSUB effect2
	IF cont.key = 3 THEN GOSUB effect3
	IF cont.key = 4 THEN GOSUB effect4
	IF cont.key = 5 THEN GOSUB effect5

	DO
	WAIT
	LOOP UNTIL cont.key = 12

	GOTO main_loop

effect1:	PROCEDURE
	GOSUB reset_sound
	FOR A = 1 TO 10
        IF A=1 THEN #C=477
        IF A=2 THEN #C=379
        IF A=3 THEN #C=319
        IF A=4 THEN #C=477
        IF A=5 THEN #C=379
        IF A=6 THEN #C=319
        IF A=7 THEN #C=451
        IF A=8 THEN #C=358
        IF A=9 THEN #C=301
        IF A=10 THEN #C=239
	SOUND 0,#C,PSG_ENVELOPE_ENABLE
	SOUND 1,(#C+1)/2,PSG_ENVELOPE_ENABLE
	SOUND 2,#C*2,PSG_ENVELOPE_ENABLE
	SOUND 3,6000,PSG_ENVELOPE_SINGLE_SHOT_RAMP_DOWN_AND_OFF	' Slow decay, single shot \______
	FOR C = 1 TO 30:WAIT:NEXT C
	NEXT A
	RETURN
	END

effect2:	PROCEDURE
	GOSUB reset_sound
	SOUND 1,1,0
	SOUND 2,1,0
	SOUND 4,31,$31
	SOUND 0,2000,PSG_ENVELOPE_ENABLE
	SOUND 3,32000,PSG_ENVELOPE_CYCLE_RAMP_DOWN_SAWTOOTH
	RETURN
	END

effect3:	PROCEDURE
	GOSUB reset_sound
	SOUND 4,8,$30
	SOUND 0,50,PSG_ENVELOPE_ENABLE
	SOUND 3,400,PSG_ENVELOPE_CYCLE_RAMP_UP_TRIANGLE
	RETURN
	END

effect4:	PROCEDURE
	GOSUB reset_sound
	SOUND 4,10,$31
	SOUND 0,2000,PSG_ENVELOPE_ENABLE
	SOUND 3,4000,PSG_ENVELOPE_CYCLE_RAMP_UP_TRIANGLE
	RETURN
	END

effect5:	PROCEDURE
	GOSUB reset_sound
	SOUND 0,100,PSG_ENVELOPE_ENABLE
	SOUND 1,400,PSG_ENVELOPE_ENABLE
	SOUND 3,3600,PSG_ENVELOPE_CYCLE_RAMP_UP_SAWTOOTH
	RETURN
	END

reset_sound:	PROCEDURE
	SOUND 0,1,0
	SOUND 1,1,0
	SOUND 2,1,0
	SOUND 4,,$38
	RETURN
	END

